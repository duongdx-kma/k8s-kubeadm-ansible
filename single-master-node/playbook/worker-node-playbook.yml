- name: Worker node configuration and join node
  become: yes
  hosts: worker_node
  tasks:
  - name: Copy token to worker nodes
    copy:
      src: /tmp/kubernetes_join_command
      dest: /tmp/kubernetes_join_command
      mode: 0777

  - name: Resetting kubeadm
    shell: kubeadm reset -f
    register: output

  - name: Join the Worker nodes with the master.
    command: sh /tmp/kubernetes_join_command
    register: joined_or_not

  - debug:
      msg: "{{ joined_or_not.stdout }}"